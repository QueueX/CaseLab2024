# CaseLab Java 2024
Данное приложение было разработано Запара Иванов в рамках CaseLab Java 2024, проводимого компанией GreenAtom
Приложение представляет собой микросервисное приложение (API) хранилища различных файлов и их аттрибутов

## Технологии
- Java 21
- Spring Boot 3.3.0
- Gradle (Kotlin)
- PostgreSQL 16.3
- Flyway
- Docker
- Swagger 3.0.0
- Git
- JUnit, Mockito

## Этапы разработки
Разработка решения проходила в несколько этапов:
- **Построение Базы данных.** Изначально была составленная схема базы данных, содержащая поля, требуемые по техническому заданию
- **Написание SQL-скрипта для создания таблицы.** Дальнейшим шагом стало написание скрипта, который создаст использующуюся далее таблицу
- **Написание сервиса миграции базы данных.** Для полноценной работы с базой данных, а также возможности ее поддержки и дальнейшего улучшения было принято решение написать микросервис, занимающийся миграцией базы данных. Также данный подход позволит получить подобие *"Системы управления версиями"* базы данных
- **Создание структуры основного микросервиса.** Были добавлены основные контроллер, сервис и репозиторий, необходимые для работы приложения
- **Внедрение Docker.** Были написанны необходимые для контейнеризации Dockerfile и docker-compose.yml для каждого микросервиса и базы данных
- **Добавление основного функционала.** Были добавлены основные функции, описанные в начальном тз
- **Покрытие проекта Unit-тестами.** Были написаны модульные тесты для готового функционала. Также был проведен Bugfix на основании результатов тестов
- **Добавление и тестирование ленты с пагинацией.** Был написан функционал для получения ленты и разбивкой ее на страницы. Также были написаны соответствующие тесты и Bugfix
- **Добавление Swagger документации.** Все методы, параметры и dto были задокументированы с помощью Swagger, для упрощения работы с API другим разработчикам

## Инструкция по запуску приложения
Для запуска приложения на своем компьютере вам необходимо иметь:
- Git
- Docker
- Java 21 или выше

***ИНСТРУКЦИЯ ПО ЗАПУСКУ ПРЕДНАЗНАЧЕНА ДЛЯ ЗАПУСКА НА ОС WINDOWS***

Для начала откройте ***Терминал Windows*** *(Win + R, введите cmd и нажмите Выполнить)*

Запуск приложения проходит в несколько этапов:
### 1. Клонирование репозитория
Для запуска приложения вам необходимо склонировать репозиторий. Для этого необходимо ввести команду:
  ```shell
  git clone https://github.com/QueueX/CaseLab2024.git
  cd CaseLab2024
  ```
После выполнения этих команд вы окажитесь в директории проекта и можете перейти к следующему этапу

### 2. Упаковка Jar-файлов
Для запуска приложения внутри Docker контейнеров необходимо собрать Jar архивы. Для этого выполните команду:
  ```shell
  gradlew clean build bootJar
  ```
Приложение установит все необходимые зависимости и пройдет через все этапы сборки проекта *(включая прохождение модульных тестов)*

### 3. Запуск Docker контейнеров
Финальным этапом служит запуск докер контейнеров. Для этого необходимо выполнить команду:
  ```shell
  docker compose up -d --build
  ```
Данная команда запустит сборку образов и запуск контейнеров Docker в фоновом режиме

***ВЫ ГОТОВЫ К РАБОТЕ***

## Тестируем работу приложения
Полную Swagger документацию можно увидеть по адресу http://localhost:8080/swagger-ui.html

Также ниже приведены несколько CURL запросов, чтобы вы могли протестировать работу приложения ***"Неотходя от терминала"***. Все что вам требуется - просто вставить данные команды в терминал и, *при желании*, откорректировать данные внутри запросов. Также для теста API можете использовать Postman (рекомендую предварительно использовать Swagger документацию)

### Отправка файла:
  #### CURL-запрос:
  ```shell
  curl -L "http://localhost:8080/api/file-storage/create" ^
  -H "Content-Type: application/json" ^
  -d "{\"title\": \"Title\", \"creationDate\": \"2010-01-02T00:10:00\", \"description\": \"This is descryption for Title file\", \"file\": \"/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgICAgMCAgIDAwMDBAYEBAQEBAgGBgUGCQgKCgkICQkKDA8MCgsOCwkJDRENDg8QEBEQCgwSExIQEw8QEBD=\"}"
  ```

### Получение файла по id
  #### CURL-запрос:
  ```shell
  curl -L "http://localhost:8080/api/file-storage/file/id1"
  ```
  #### Тело запроса:
  ```json
  {
    "title" : "Title",
    "creationDate" : "2010-01-02T00:10:00",
    "description" : "This is descryption for Title file",
    "file" : "/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgICAgMCAgIDAwMDBAYEBAQEBAgGBgUGCQgKCgkICQkKDA8MCgsOCwkJDRENDg8QEBEQCgwSExIQEw8QEBD="
  }
  ```

### Получение первой страницы ленты с файлами
  #### CURL-запрос:  
  ```shell
  curl -L "localhost:8080/api/file-storage/files/1"
  ```

### Получение первой страницы ленты с файлами отсортированные по дате (сначала ранние)
  #### CURL-запрос:
  ```shell
  curl -L "localhost:8080/api/file-storage/files/1?sort=asc"
  ```

### Получение первой страницы ленты с файлами отсортированные по дате (сначала поздние)
  #### CURL-запрос:  
  ```shell
  curl -L "localhost:8080/api/file-storage/files/1?sort=desc"
  ```
